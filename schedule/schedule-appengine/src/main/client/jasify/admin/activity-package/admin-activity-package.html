<style>
    /* ========================================================================================
       TODO: Move this to application.less after dragonflypl tells us how that should look like
       And these should be using the bootstrap variables
       ======================================================================================== */
    .activity-list-item {
        padding: 5px;
        margin: 5px 0;
        border: 1px solid #eee;
        border-left-width: 5px;
        border-radius: 3px;
    }

    .activity-list-item-selected {
        border-left-color: #6d96d0;
    }

    .activity-list-item-danger {
        border-left-color: #ce4844;
    }

    .activity-list-item-available {
        border-left-color: #19631f;
    }

</style>

<div class="row">
    <div class="col-sm-1">
        <a ng-click="vm.back()"><span class="glyphicon glyphicon-arrow-left"></span> back</a>
    </div>
    <div class="col-sm-4">
        <form class="form-horizontal" role="form" name="vm.organizationForm" novalidate>
            <div class="form-group">
                <label class="control-label col-sm-4" for="organization">Organization:</label>

                <div class="col-sm-7">
                    <select ng-model="vm.organization" id="organization" class="form-control"
                            ng-options="organization as organization.name for organization in vm.organizations"
                            ng-change="vm.onOrganizationSelected(vm.organization)">
                    </select>
                </div>
            </div>
        </form>
    </div>
    <div class="col-sm-7">
        <alert ng-repeat="a in vm.alerts" type="{{a.type}}" close="vm.alerts.splice($index, 1)">{{a.msg}}</alert>
    </div>
</div>
<div class="row">
    <div class="col-sm-6 well well-sm text-center" ng-hide="vm.organization.id">Select an organization.</div>
    <div class="col-sm-6" ng-show="vm.organization.id">
        <form class="form-horizontal" role="form" name="vm.activityPackageForm" novalidate>
            <fieldset>
                <legend class="h4">Activity Package</legend>
                <div class="form-group">
                    <label for="name" class="col-sm-3 control-label">Name:</label>

                    <div class="col-sm-8">
                        <input id="name" type="text" class="form-control" ng-model="vm.activityPackage.name" required/>
                    </div>
                </div>
                <div class="form-group">
                    <label for="description" class="col-sm-3 control-label">Description:</label>

                    <div class="col-sm-8">
                    <textarea class="form-control input-sm" id="description" ng-model="vm.activityPackage.description"
                              rows="3">
                    </textarea>
                    </div>
                </div>
                <div class="form-group">
                    <label for="price" class="col-sm-3 control-label">Price:</label>

                    <div class="col-sm-3">
                        <input id="price" type="number" min="0" class="form-control" ng-model="vm.activityPackage.price"
                               ng-change="vm.activityPackage.currency='CHF'"/>
                    </div>
                    <div class="col-sm-2 text-left">
                        <select ng-model="vm.activityPackage.currency" class="form-control">
                            <option>CHF</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="itemCount" class="col-sm-3 control-label"
                           tooltip="Number of activities a client can subscribe to">Item Count:</label>

                    <div class="col-sm-8">
                        <input id="itemCount" type="number" min="0" class="form-control"
                               ng-model="vm.activityPackage.itemCount"/>
                    </div>
                </div>
            </fieldset>
            <fieldset>
                <legend class="h4">Activities</legend>
                <div class="form-group">
                    <div class="col-sm-5">
                        <h5>Available</h5>

                        <div class="activity-list-item activity-list-item-danger" ng-hide="vm.activities.length > 0">
                            No activities available.
                        </div>

                        <div class="activity-list-item activity-list-item-available small"
                             ng-repeat="activity in vm.activities | filter:vm.filterSelected">

                            <button type="button" class="close" aria-label="Select"
                                    ng-click="vm.selectActivity(activity)" tooltip="Select">
                                <span class="glyphicon glyphicon-arrow-right" aria-hidden="true"></span>
                            </button>

                            <div>
                                <strong>
                                    {{activity.start | date:'EEE, dd MMM'}}
                                </strong>
                                <i>
                                    ({{activity.start | date:'HH:mm'}} - {{activity.finish | date:'HH:mm'}})
                                </i>
                            </div>
                            {{activity.name || activity.activityType.name}}
                        </div>
                    </div>
                    <div class="col-sm-5 col-sm-offset-1">
                        <h5>Selected</h5>

                        <div class="activity-list-item" ng-hide="vm.selectedActivities.length > 0">
                            No activities selected.
                        </div>

                        <div class="activity-list-item activity-list-item-selected small"
                             ng-repeat="activity in vm.selectedActivities">

                            <button type="button" class="close" aria-label="Remove"
                                    ng-click="vm.deselectActivity(activity.id)" tooltip="Remove">
                                <span aria-hidden="true">&times;</span>
                            </button>

                            <div>
                                <strong>
                                    {{activity.start | date:'EEE, dd MMM'}}
                                </strong>
                                <i>
                                    ({{activity.start | date:'HH:mm'}} - {{activity.finish | date:'HH:mm'}})
                                </i>
                            </div>
                            {{activity.name || activity.activityType.name}}
                        </div>
                    </div>
                </div>
            </fieldset>
            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                    <button type="button" ng-if="vm.activity.id"
                            ng-click="vm.update()"
                            ng-disabled="!vm.activityPackageForm.$dirty || vm.activityPackageForm.$invalid"
                            class="btn btn-default btn-sm btn-primary">
                        <span class="glyphicon glyphicon-save"></span> update
                    </button>
                    <button type="button" ng-if="!vm.activity.id"
                            ng-click="vm.create()"
                            ng-disabled="!vm.activityPackageForm.$dirty || vm.activityPackageForm.$invalid"
                            class="btn btn-default btn-sm btn-primary">
                        <span class="glyphicon glyphicon-plus"></span> create
                    </button>
                    <button type="button"
                            ng-click="vm.reset()" ng-disabled="!vm.activityPackageForm.$dirty"
                            class="btn btn-default btn-sm">
                        <span class="glyphicon glyphicon-open"></span> reset
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>
