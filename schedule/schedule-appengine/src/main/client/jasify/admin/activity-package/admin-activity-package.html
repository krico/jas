<form novalidate name="vm.activityPackageForm" class="form-horizontal" role="form"
      ng-submit="vm.activityPackageForm.$valid && vm.save(vm.activityPackage)">
    <div class="card">
        <div class="card-header" ng-if="!vm.activityPackage.id">
            <div class="actions-group">
                <a-button type="submit" controller="vm.saveBtn"></a-button>
                <a-button type="button" ng-click="vm.reset()" controller="vm.resetBtn"></a-button>
            </div>
            <a class="back-button"
               ng-href="#/admin/activity-packages/{{vm.activityPackage.organizationId || vm.organization.id}}">
                <button title="Back" class="btn btn-info btn-icon"><i class="md mdi-undo"></i></button>
            </a>
            <h2>New Activity Package
                <small>Group Activities into Package</small>
            </h2>
        </div>
        <div class="card-header" ng-if="vm.activityPackage.id">
            <div class="actions-group">
                <a-button type="submit" controller="vm.saveBtn"></a-button>
                <a-button type="button" ng-click="vm.reset()" controller="vm.resetBtn"></a-button>
            </div>
            <a class="back-button"
               ng-href="#/admin/activity-packages/{{vm.activityPackage.organizationId || vm.organization.id}}">
                <button title="Back" class="btn btn-info btn-icon"><i class="md mdi-undo"></i></button>
            </a>
            <h2>Edit Activity Package
                <small>Group Activities into Package</small>
            </h2>
        </div>
        <div class="card-body card-padding-sm">
            <div jas-has-feedback class="form-group">
                <label for="name" class="col-sm-2 control-label">Name:</label>

                <div class="col-sm-4">
                    <div class="fg-line">
                        <input placeholder="Enter name" ng-model="vm.activityPackage.name" type="text"
                               class="form-control" id="name" name="name" required/>
                    </div>
                    <jas-feedback-icon-valid field="vm.activityPackageForm.name"></jas-feedback-icon-valid>
                    <jas-feedback-icon-invalid field="vm.activityPackageForm.name"
                                               form="vm.activityPackageForm"></jas-feedback-icon-invalid>
                    <jas-error-help-block field="vm.activityPackageForm.name" form="vm.activityPackageForm">
                        <span ng-message="required">Name is required.</span>
                    </jas-error-help-block>
                </div>
            </div>
            <div jas-has-feedback class="form-group">
                <label for="description" class="col-sm-2 control-label">Description:</label>

                <div class="col-sm-4">
                    <div class="fg-line">
                        <textarea ng-model="vm.activityPackage.description"
                                  id="description" name="description"
                                  required
                                  class="form-control" rows="3" placeholder="Enter description">
                        </textarea>
                    </div>
                    <jas-feedback-icon-valid field="vm.activityPackageForm.description"></jas-feedback-icon-valid>
                    <jas-feedback-icon-invalid field="vm.activityPackageForm.description"
                                               form="vm.activityPackageForm"></jas-feedback-icon-invalid>
                    <jas-error-help-block field="vm.activityPackageForm.description" form="vm.activityPackageForm">
                        <span ng-message="required">Description is required.</span>
                    </jas-error-help-block>
                </div>
            </div>
            <div jas-has-feedback class="form-group">
                <label for="price" class="col-sm-2 control-label">Price:</label>

                <div class="col-sm-4">
                    <div class="fg-line">
                        <input id="price" name="price" type="number" min="0" max="10000" class="form-control"
                               ng-model="vm.activityPackage.price" required placeholder="Enter price"
                               ng-change="vm.activityPackage.currency='CHF'"/>
                    </div>
                    <jas-feedback-icon-valid field="vm.activityPackageForm.price"></jas-feedback-icon-valid>
                    <jas-feedback-icon-invalid field="vm.activityPackageForm.price"
                                               form="vm.activityPackageForm"></jas-feedback-icon-invalid>
                    <jas-error-help-block field="vm.activityPackageForm.price" form="vm.activityPackageForm">
                        <span ng-message="required">Price is required.</span>
                        <span ng-message="number">Invalid number.</span>
                        <span ng-message="min">Value must be greater than or equal to 0.</span>
                        <span ng-message="max">Value must be smaller than 10000.</span>
                    </jas-error-help-block>
                </div>
            </div>
            <div jas-has-feedback class="form-group">
                <label for="currency" class="col-sm-2 control-label">Currency:</label>

                <div class="col-sm-4">
                    <div class="fg-line">
                        <div class="select">
                            <select ng-model="vm.activityPackage.currency" name="currency" id="currency" required
                                    class="form-control">
                                <option>CHF</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div jas-has-feedback class="form-group">
                <label for="itemCount" class="col-sm-2 control-label"
                       tooltip="Number of activities a client can subscribe to">Item Count:</label>

                <div class="col-sm-4">
                    <div class="fg-line">
                        <input id="itemCount" name="itemCount" type="number"
                               min="2" max="100" class="form-control" placeholder="Enter Item Count"
                               ng-model="vm.activityPackage.itemCount" required/>
                    </div>
                    <jas-feedback-icon-valid field="vm.activityPackageForm.itemCount"></jas-feedback-icon-valid>
                    <jas-feedback-icon-invalid field="vm.activityPackageForm.itemCount"
                                               form="vm.activityPackageForm"></jas-feedback-icon-invalid>
                    <jas-error-help-block field="vm.activityPackageForm.itemCount" form="vm.activityPackageForm">
                        <span ng-message="required">Item Count is required.</span>
                        <span ng-message="number">Invalid number.</span>
                        <span ng-message="min">Value must be greater than 1.</span>
                        <span ng-message="max">Value must be smaller than 100.</span>
                    </jas-error-help-block>
                </div>
            </div>
            <div jas-has-feedback class="form-group">
                <label class="control-label col-sm-2" for="organization">Organization:</label>

                <div class="col-sm-4">
                    <div class="fg-line">
                        <div class="select">
                            <select id="organization" name="organization" class="form-control"
                                    ng-model="vm.organization" required
                                    ng-disabled="vm.activityPackage.id"
                                    ng-options="organization as organization.name for organization in vm.organizations"
                                    ng-change="vm.onOrganizationSelected(vm.organization)">
                            </select>
                        </div>
                    </div>
                    <jas-feedback-icon-valid field="vm.activityPackageForm.organization"></jas-feedback-icon-valid>
                    <jas-feedback-icon-invalid field="vm.activityPackageForm.organization"
                                               form="vm.activityPackageForm"></jas-feedback-icon-invalid>
                    <jas-error-help-block field="vm.activityPackageForm.organization" form="vm.activityPackageForm">
                        <span ng-message="required">Organization is required.</span>
                    </jas-error-help-block>
                </div>
            </div>

            <md-subheader class="md-no-sticky bgm-bluegray c-white">Activities ({{vm.selectedActivities.length || 0}} selected)</md-subheader>
            <div id="activity-selection-lists" class="row">
                <div class="col-xs-6">
                    <md-list>
                        <md-subheader class="md-no-sticky">Available <br class="visible-xs-block" /> (click to select)</md-subheader>
                        <md-list-item ng-click="vm.selectActivity(activity)" div layout="row"
                                      layout-align="start center" class="md-2-line"
                                      ng-repeat="activity in vm.activities | filter:vm.filterSelected">
                            <md-divider></md-divider>
                            <div class="md-list-item-text">
                                <h3> {{ activity.activityType.name }} </h3>

                                <p> {{[activity.start, activity.finish] | tableShortDateTime}} </p>

                                <p> Price: {{activity.price}} {{activity.currency}}</p>
                            </div>
                        </md-list-item>
                    </md-list>
                </div>
                <div class="col-xs-6">
                    <md-list>
                        <md-subheader class="md-no-sticky">Selected <br class="visible-xs-block"  /> (click to deselect)</md-subheader>
                        <md-list-item ng-click="vm.deselectActivity(activity.id)" div layout="row"
                                      layout-align="start center" class="md-2-line"
                                      ng-repeat="activity in vm.selectedActivities">
                            <md-divider></md-divider>
                            <div class="md-list-item-text">
                                <h3> {{ activity.activityType.name }} </h3>

                                <p> {{[activity.start, activity.finish] | tableShortDateTime}} </p>

                                <p> Price: {{activity.price}} {{activity.currency}}</p>
                            </div>
                        </md-list-item>
                    </md-list>
                </div>
            </div>
        </div>
    </div>
</form>
